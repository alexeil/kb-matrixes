<h2>Tournament details</h2>

<div style="display: flex; align-items: center; gap: 24px;">
  <mat-form-field appearance="outline">
    <mat-label>Location</mat-label>
    <input matInput type="text" [ngModel]="scheduleConfig.location" (ngModelChange)="scheduleConfig.setLocation($event)" placeholder="Enter city name" />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Date</mat-label>
    <input matInput [matDatepicker]="picker" [ngModel]="scheduleConfig.scheduleDate"
      (ngModelChange)="scheduleConfig.setScheduleDate($event)" placeholder="Select date" />
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Start Time</mat-label>
    <input matInput type="time" [ngModel]="scheduleConfig.scheduleStart"
      (ngModelChange)="scheduleConfig.setScheduleStart($event)" />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Duration between games (minutes)</mat-label>
    <input matInput type="number" [ngModel]="scheduleConfig.scheduleInterval"
      (ngModelChange)="scheduleConfig.setScheduleInterval($event)" min="1" />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Number of fields</mat-label>
    <input matInput type="number" [ngModel]="scheduleConfig.fields" (ngModelChange)="scheduleConfig.setFields($event)"
      min="1" />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Number of Sets</mat-label>
    <input matInput type="number" [ngModel]="scheduleConfig.numberOfSets"
      (ngModelChange)="scheduleConfig.setNumberOfSets($event)" min="1" placeholder="e.g. 3" />
  </mat-form-field>
</div>

<button mat-raised-button color="primary" (click)="addCategory()">Add Category</button>

<button mat-raised-button color="accent" (click)="setTestData()">Set Test Data</button>

<button mat-raised-button color="primary" (click)="copyShareUrl()">Share Setup</button>

<mat-tab-group [(selectedIndex)]="mainTabIndex">
  <!-- Teams/Matrix/Game Sheets Tab -->
  <mat-tab label="Register Teams & select Matrix">
    <mat-tab-group [(selectedIndex)]="selectedCategoryIndex">
      @for (cat of categories; track cat; let i = $index) {
        <mat-tab>
          <ng-template mat-tab-label>
            <input [(ngModel)]="cat.name"
              style="width: 100px; border: none; background: transparent; font-weight: bold;" />
            <button extended (click)="removeCategory(i)"
              style="border: none; background: transparent; cursor: pointer; color: red;">
              <mat-icon>delete</mat-icon>
            </button>
          </ng-template>
          <br /><br /><br />
          <div class="team-matrix-grid">
            <app-team-input [teams]="cat.teams" [catIndex]="i"></app-team-input>
            <app-matrix [teams]="cat.teams" [catIndex]="i"></app-matrix>
          </div>
        </mat-tab>
      }
    </mat-tab-group>
  </mat-tab>

  <!-- Schedule Tab -->
  <mat-tab label="Create the Schedule">
    <app-schedule></app-schedule>
  </mat-tab>

  <mat-tab label="Let's print it!">
    @for (cat of categories; track cat; let i = $index) {
      <app-ranking [lang]="lang" [catIndex]="i"></app-ranking>
    }
    <ng-container *ngIf="scheduledGames$ | async as scheduledGames">
      @for (field of scheduledGames; track field; let fieldIdx = $index) {
        <app-game-sheet [catIndex]="1" [fieldNumber]="fieldIdx + 1" [games]="field"></app-game-sheet>
      }
    </ng-container>
    <app-game-sheet [catIndex]="1"></app-game-sheet>
  </mat-tab>
</mat-tab-group>